<apex:page standardController="Contact"
           	extensions="VFP_PDF_Contact_Controller"
            applyBodyTag="false"
            showHeader="false"
            sidebar="false"
            renderAs="PDF">

    <head>
        <title>Trade Custodian Invoice</title>
        <style>
            @page {
                size: 215.9mm 279.4mm;
                margin: 45px;
                /*margin: 22px;*/
                /*margin-top: 120px;*/
                margin-bottom: 28px;
                margin-top: 54px;
                @top-center {
                    content: element(header);
                }
                @bottom-left {
                    content: element(footer);
                }
            }
            .page:before {
                content: counter(page);
            }
            .pages:after {
                content: counter(pages);
            } 
            div.header {
            	padding-top: 12px;
                position: running(header);
            }
            
            div.footer {
                padding-bottom: 18px;
                position: running(footer);
            }
            
            .bold_text{
                font-weight: bold;
                line-height: 15px;
            }
            
            hr{
            	width: 100%;
            	align: center;
            }
            
            .total{
            	background-color: black;
            	color: white;
            }
            
            .customer thead tr {
            	background-color: black;
            	color: white;
            	text-align: center;
            }
            
            .customer tbody tr {
            	background-color: #CDCDCD;
            	text-align: center;
            }
            
            .items thead tr {
            	background-color: #ADD8E6;
            	color: black;
            	text-align: center;
            }
            
            th.all_border, td.all_border{
                padding-right: 6px;
            	padding-left: 6px;
            }
            
            .fields tr td{            
                padding-bottom: 12px;
            }
            
            .contact-img { max-height: 120px; }
            
            .contact_name{
            	font-size: 36px;
                line-height: 15px;
            }
            .contact_title{
            	font-size: 20px;
            }
            .section_header{
            	font-size: 24px;
                line-height: 3px;
            	padding-left: 10px;
            }
            .section{
            	margin-top: 30px;
            }
            .label_field{
            	font-weight: bold;
            }
           .div_contact{
            	margin-top: 30px;
            	background-color: #87CEEB;
            	text-align: center;
            	color: white;
				border: 1px solid black;
            	padding-bottom: 12px;
            	font-weight: bold;
            	font-size: 22px;
            }
            .header_related{
            	margin-top: 30px;
            	padding-left: 15px;
            	background-color: #c4cbd4;
            	padding-bottom: 12px;
            	padding-top: 12px;
            	font-weight: 900;
            }

            .related_items, .items {
                -Fs-table-paginate: paginate;
            }

            .related_items_relationships {
                -Fs-table-paginate: paginate;
            }

            .related_items thead tr {
            	background-color: #f5f5f5;
            	color: black;
            	text-align: center;
            }

            .related_items_relationships thead tr {
            	background-color: #f5f5f5;
            	color: black;
            	text-align: center;
            }
            
            th.related_all_border, td.related_all_border{
            	border: 1px solid black;
            	padding-right: 6px;
            	padding-left: 6px;
            }

            .border_right{
                border-right: 1px solid black;
            }
            .border_left{
                border-left: 1px solid black;
            }

            .border_bottom{
                border-bottom: 1px solid black;
            }

            .border_top{
                border-top: 1px solid black;
            }

            .table_borders{
                border-right: 1px solid black !important;
                border-bottom: 1px solid black !important;
            }

            .table_borders_rel{
                border-bottom: 1px solid black !important;
            }

            .box_padding{
                padding-right: 6px;
            	padding-left: 6px;
            }

            .padding_top{
                padding-top: 6px;
            }

            .vertical_align_top{
                vertical-align: top;
            }

            .special_Border_cell{ position:relative; }
            .special_Border{ 
                font-size: 1px; 
                position: absolute;
                top:0;
                left: -1px;
                bottom: 0;
                background: black; 
                width: 0.5px;
            }
            .introductions_border{
                height: 39px;
            }
            .relationships_Network_border{
                height: 21px;
            }
            .p_min > p{
                line-height: normal ;
                margin-top: 0 ;
                margin-bottom: 0 ;
            }
            .p_min > ol{
                line-height: normal ;
                margin-top: 0 ;
                margin-bottom: 0 ;
            }
        </style>
    </head>
    
    <body>
        <div class="header">
            <table cellspacing="0" border="0" width="100%">
                <tr>
                    <td width="25%" valign="top" align="left">&nbsp;</td>
                    <td width="63%" valign="center"></td>
                    <td width="12%" valign="top" align="left"><img width="100%" src="{!URLFOR($Resource.AvantGlobalLogo)}" /></td>
                </tr>
            </table>
            <br/>
        </div>
        
        <div style="page-break-after:always;">
            <table cellspacing="0" border="0" width="100%">
                <tr>
                    <td width="25%" valign="top" align="left">
                    	<apex:image value="{!URLFOR($Resource.PictureUploader, '/default-avatar.png')}" rendered="{!NOT( hasPicture )}" styleClass="contact-img" />
                        <apex:outputpanel rendered="{!hasPicture}">
                        	<img width="100%" src="/servlet/servlet.FileDownload?file={!file.Id}" />
                        </apex:outputpanel>
                    </td>
                    <td width="57.5%" valign="center" style="padding-left: 10px;">
                        <span class="contact_name">{!Contact.Name}</span><br/>
                        <p class="contact_title">
                            {!Contact.Company__c}<br/>
                        	{!Contact.Job_Title__c}
                        </p>
                    </td>
                    <td width="17.5%" valign="top" align="left">&nbsp;</td>
                </tr>
            </table>
            
            <div class="section">
                <span class="section_header">Context</span>
                <hr/>
                <p>
                    {!Contact.Context__c}
                </p>
                <p>
                    <span class="label_field">Introduced By: </span> {!Contact.ReportsTo.Name}
                </p>
            </div>
            
            <div class="section">
                <span class="section_header">Contact Information</span>
                <hr/>
                <table cellspacing="0" border="0" width="100%">
                    <tr>
                        <td width="50%" valign="top" align="left">
                            <span class="label_field">Office: </span> {!Contact.Phone}<br/>
                            <span class="label_field">Mobile: </span> {!Contact.MobilePhone}<br/>
                            <span class="label_field">Email: </span> {!Contact.Email}<br/>
                            <span class="label_field">Website: </span> {!Contact.Website__c}<br/>
                        </td>
                        <td width="50%" valign="top">
                            <span class="label_field">Office Address: </span><br/>
                            {!Contact.MailingStreet}<br/> 
                            {!Contact.MailingCity}, {!Contact.MailingState} {!Contact.MailingPostalCode}<br/>
                            {!Contact.MailingCountry}<br/>
                        </td>
                    </tr>
                </table>
            </div>
            
            <div class="section">
                <span class="section_header">Assistant Information</span>
                <hr/>
                <table cellspacing="0" border="0" width="100%">
                    <tr>
                        <td width="33%" valign="top" align="left">
                            <span class="label_field">Assistant Name: <br/></span>{!Contact.AssistantName}<br/>
                        </td>
                        <td width="33%" valign="top">
                            <span class="label_field">Email: <br/></span>{!Contact.Asst_Email__c}<br/>
                        </td>
                        <td width="33%" valign="top">
                            <span class="label_field">Phone: <br/></span>{!Contact.AssistantPhone}<br/>
                        </td>
                    </tr>
                </table>
            </div>
            
            <div class="section">
                <span class="section_header">Context Data</span>
                <hr/>
                <table cellspacing="0" border="0" width="100%">
                    <tr>
                        <td width="60%" valign="top" align="left">
                            <span class="label_field">Sector: </span> {!Contact.Sector__c}<br/>
                            <span class="label_field">Industry: </span> {!Contact.Industry__c}<br/>
                            <span class="label_field">Sub-Industry: </span> {!Contact.Sub_Industry__c}<br/>
                        </td>
                        <td width="40%" valign="top">
                            <span class="label_field">Goal: </span> {!Contact.Goal__c}<br/>
                            <span class="label_field">Niche: </span> {!Contact.Niche_Theme__c}<br/>
                            <span class="label_field">Role: </span> {!Contact.Role__c}<br/>
                        </td>
                    </tr>
                </table>
            </div>
            
            <div class="section">
                <span class="section_header">Demographic Data</span>
                <hr/>
                <table cellspacing="0" border="0" width="100%">
                    <tr>
                        <td width="60%" valign="top" align="left">
                            <span class="label_field">Strength of Relationship: </span> {!Contact.Strength_of_Relationship__c}<br/>
                            <span class="label_field">Openness to Communicaton: </span> {!Contact.Open_to_Communication__c}<br/>
                            <span class="label_field">Communication Method: </span> {!Contact.Communication_Method__c}<br/><br/>
                            <span class="label_field">Wealth: </span> {!Contact.Wealth__c}<br/>
                            <span class="label_field">Age: </span> {!Contact.Age__c}<br/>
                        </td>
                        <td width="40%" valign="top">
                            <span class="label_field">Willingness to Participate: </span> {!Contact.Willingness_to_Participate__c}<br/>
                            <span class="label_field">Maslo-Hierarchy: </span> {!Contact.Maslo_Hierarchy__c}<br/>
                            <span class="label_field">Politics: </span> {!Contact.Politics__c}<br/><br/>
                            <span class="label_field">Spouse: </span> {!Contact.Spouse__c}<br/>
                            <span class="label_field">Birthday: </span> <apex:outputText value="{0, date, MM'-'dd'-'yyyy}"><apex:param value="{!Contact.Birthdate}" /></apex:outputText><br/>
                        </td>
                    </tr>
                </table>
            </div>
        </div>
        
        <div style="page-break-after:always;">
        	<div class="section">
                <span class="section_header">Investor Profile</span>
                <hr/>
                <table border="0" cellspacing="0" width="100%" class="items">
                    <tbody>
                        <tr>
                            <td width="25%"><span class="label_field">Role: </span></td>
                            <td width="75%"> {!Contact.Investor_Role__c} </td>
                        </tr>
                        <tr>
                            <td  class="vertical_align_top padding_top" width="25%"><span class="label_field">Asset Allocation Interest: </span></td>
                            <td  class="vertical_align_top padding_top" width="75%"> {!Contact.Asset_Allocation_Interest__c} </td>
                        </tr>
                        <tr>
                            <td  class="vertical_align_top padding_top" width="25%"><span class="label_field">Risk Profile: </span></td>
                            <td  class="vertical_align_top padding_top" width="75%">{!Contact.Risk_Profile__c}</td>
                        </tr>

                        <tr>
                            <td  class="vertical_align_top padding_top" width="25%"><span class="label_field">Investment Sizes:  </span></td>
                            <td  class="vertical_align_top padding_top" width="75%">{!Contact.Investment_Sizes__c}</td>
                        </tr>

                        <tr>
                            <td  class="vertical_align_top padding_top" width="25%"><span class="label_field">Deal/Company Sizes: </span></td>
                            <td  class="vertical_align_top padding_top" width="75%">{!Contact.Deal_Company_Sizes__c}</td>
                        </tr>

                        <tr>
                            <td  class="vertical_align_top padding_top" width="25%"><span class="label_field">Governance Requirements: </span></td>
                            <td  class="vertical_align_top padding_top" width="75%">{!Contact.Governance_Requirements__c}</td>
                        </tr>

                        <tr>
                            <td  class="vertical_align_top padding_top" width="25%"><span class="label_field">Investment Next Step: </span></td>
                            <td  class="vertical_align_top padding_top" width="75%">{!Contact.Investment_Next_Steps__c}</td>
                        </tr>
                        
                        <tr>
                            <td  class="vertical_align_top padding_top" width="25%"><span class="label_field">Structure:  </span></td>
                            <td  class="vertical_align_top padding_top" width="75%">{!Contact.Structure__c}</td>
                        </tr>

                        <tr>
                            <td  class="vertical_align_top padding_top" width="25%"><span class="label_field">Investment Stage: </span></td>
                            <td  class="vertical_align_top padding_top" width="75%">{!Contact.Investment_Stage__c}</td>
                        </tr>

                        <tr>
                            <td  class="vertical_align_top padding_top" width="25%"><span class="label_field">Investment Industries: </span></td>
                            <td  class="vertical_align_top padding_top"  width="75%">{!Contact.Investment_Industries__c}</td>
                        </tr>
                        
                    </tbody>
                </table>
            </div>
            
            <div class="section">
                <span class="section_header">Investor Profile Notes</span>
                <hr/>
                <p>
                    <span class="label_field">Asset Allocation Notes: </span> <br/>
                    {!Contact.Asset_Allocation_Notes__c}
                </p>
                <p>
                    <span class="label_field">Areas To Avoid: </span> <br/>
                    {!Contact.Areas_To_Avoid__c}
                </p>
                <p>
                    <span class="label_field">Investment Stage Notes: </span> <br/>
                    {!Contact.Investment_Stage_Notes__c}
                </p>
                <p>
                    <span class="label_field">Investment Industry Notes: </span> <br/>
                    {!Contact.Investment_Industry_Notes__c}
                </p>
                <p>
                    <span class="label_field">Deal/Company Size Notes: </span> <br/>
                    {!Contact.Deal_Company_Size_Notes__c}
                </p>
                <p>
                    <span class="label_field">Next Step Notes: </span> <br/>
                    {!Contact.Next_Step_Notes__c}
                </p>
            </div>
        </div>
        
        <div style="page-break-after:always;">
            <div class="section">
                <span class="section_header">Introductions</span>
                <hr/>
                <table border="0" cellspacing="0" width="100%" class="items">
                    <thead class="border_top">
                            <tr>
                                <th class="box_padding table_borders border_top border_left" width="10%">#</th>
                                <th class="box_padding table_borders border_top" width="30%">Introduction Name</th>
                                <th class="box_padding table_borders border_top" width="20%">Contact</th>
                                <th class="box_padding table_borders border_top" width="20%">Contact</th>
                                <!--<th class="box_padding table_borders border_top" width="15%">Contact</th>-->
                                <th class="box_padding table_borders border_top" width="15%">Type of Introduction</th>
                                <th class="box_padding table_borders border_top" width="15%">Introduction Date</th>
                            </tr>
                    </thead>
                    <tbody>
                        <apex:variable var="count" value="{!1}" />
                        <apex:repeat value="{!introductions}" var="introduction" >                   
                                <tr>
                                    <td  class="box_padding table_borders border_left" align="right">{!count}</td>
                                    <td  class="box_padding table_borders">  {!introduction.Name}</td>
                                    <td  class="box_padding table_borders"> {!introduction.Contact__r.Name}</td>
                                    <td  class="box_padding table_borders">  {!introduction.Contact2__r.Name}</td>
                                    <!--<td  class="box_padding table_borders">  {!introduction.Contact_3__r.Name}</td>-->
                                    <td  class="box_padding table_borders">  {!introduction.Type_of_Introduction__c}</td>
                                    <td  class="box_padding table_borders">  <apex:outputText value="{0, date, MM'-'dd'-'yyyy}"><apex:param value="{!introduction.Introduction_Date__c}" /></apex:outputText></td>
                                </tr>
                                <apex:variable var="count" value="{!count + 1}" />
                        </apex:repeat>    
                    </tbody>
                </table>
            </div>
        </div>
        
        <div style="page-break-after:always;">
            <div class="div_contact">
                <span>{!Contact.Name} - Update</span>
            </div>
            <div class="section">
                <span class="section_header">
                    <apex:outputText value="{!formattedDateWithDayOfMonthSuffix}"></apex:outputText>
                </span>
                <hr/>
                <div class="p_min">
                    <apex:outputText value="{!Contact.Client_Update1__c}" escape="false" />
                </div>
            </div>
        </div>
        
        <div style="page-break-after:always;">
            <div class="section">
                <span class="section_header">{!Contact.Name}'s Relationships &amp; Network</span>
                <hr/>
                <div>
                    <table border="0" cellspacing="0" width="100%" class="related_items_relationships">
                        <thead> 
                            <tr>
                                <th class="box_padding table_borders_rel  border_right" width="36%">Name</th>
                                <th class="box_padding table_borders_rel border_right" width="17%">Job Title</th>
                                <th class="box_padding table_borders_rel border_right" width="17%">Company</th>
                                <th class="box_padding table_borders_rel border_right" width="18%">Office City</th>
                                <th class="box_padding table_borders_rel " width="12%">Office Country</th>
                            </tr>
                        </thead>
                        <tbody>
                            <apex:variable var="count" value="{!1}" />
                            <apex:repeat value="{!contactsRelationships}" var="cr" >                   
                                    <tr>
                                        <td  class="box_padding table_borders_rel" style="{!IF(cr.typeRelation=='child' ,'padding-left: 15px;', IF(cr.typeRelation=='grandchild' ,'padding-left: 35px;','padding-left: 55px;'))}">
                                            <span style="{!IF(cr.typeRelation=='child' ,'display: block;', IF(cr.typeRelation=='grandchild' ,'display: none;','display: none;'))}"><span style="color: black;">&#8226;</span> {!cr.contact.FirstName} {!cr.contact.LastName}</span>
                                            <span style="{!IF(cr.typeRelation=='child' ,'display: none;', IF(cr.typeRelation=='grandchild' ,'display: block;','display: none;'))}"><span style="color: blue;">&#8226;</span> {!cr.contact.FirstName} {!cr.contact.LastName}</span>
                                            <span style="{!IF(cr.typeRelation=='child' ,'display: none;', IF(cr.typeRelation=='grandchild' ,'display: none;','display: block;'))}"><span style="color: red;">&#8226;</span> {!cr.contact.FirstName} {!cr.contact.LastName}</span>                                            
                                        </td>
                                        <td  class="box_padding table_borders_rel">
                                            {!cr.contact.Job_Title__c}
                                        </td>
                                        <td  class="box_padding table_borders_rel">
                                            {!cr.contact.Company__c}
                                        </td>
                                        <td  class="box_padding table_borders_rel">
                                            {!cr.contact.MailingCity}
                                        </td>
                                        <td  class="box_padding table_borders_rel">
                                            {!cr.contact.MailingCountry}
                                        </td>
                                    </tr>
                                    <apex:variable var="count" value="{!count + 1}" />
                            </apex:repeat>    
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
        
        <div style="page-break-after:always;">
            <div class="section">
                <span class="section_header">{!Contact.Name}'s Lists</span>
                <hr/>
                
                <div>
                    <div class="header_related">
                        <apex:variable var="count" value="{!0}" />
                        <apex:repeat value="{!Contact.Investor_Lists__r}" var="row">
                            <apex:variable var="count" value="{!count+1}" />
                        </apex:repeat>
                        Investor Lists ({!count})
                    </div>
                    <table border="0" cellspacing="0" width="100%" class="related_items" style="{!IF(count==0 ,'display: none;','')}">
                        <thead>
                                <tr>
                                    <th class="box_padding table_borders border_top border_left" width="10%">#</th>
                                    <th class="box_padding table_borders border_top" width="90%">Investor List Name</th>
                                </tr>
                        </thead>
                        <tbody>
                            <apex:variable var="count" value="{!1}" />
                            <apex:repeat value="{!Contact.Investor_Lists__r}" var="investor" >                   
                                    <tr>
                                        <td  class="box_padding table_borders border_left" align="right">{!count}</td>
                                        <td  class="box_padding table_borders">
                                            {!investor.Investor_List__r.Name}
                                        </td>
                                    </tr>
                                    <apex:variable var="count" value="{!count + 1}" />
                            </apex:repeat> 
                        </tbody>
                    </table>
                </div>
                
                <div>
                    <div class="header_related">
                        <apex:variable var="count" value="{!0}" />
                        <apex:repeat value="{!Contact.Lists__r}" var="row">
                            <apex:variable var="count" value="{!count+1}" />
                        </apex:repeat>
                        AG Lists ({!count})
                    </div>
                    <table border="0" cellspacing="0" width="100%" class="related_items" style="{!IF(count==0 ,'display: none;','')}">
                        <thead>
                                <tr>
                                    <th class="box_padding table_borders border_top border_left" width="10%">#</th>
                                    <th class="box_padding table_borders border_top" width="90%">AG List Name</th>
                                </tr>
                        </thead>
                        <tbody>
                            <apex:variable var="count" value="{!1}" />
                            <apex:repeat value="{!Contact.Lists__r}" var="ag" >                   
                                    <tr>
                                        <td  class="box_padding table_borders border_left" align="right">{!count}</td>
                                        <td  class="box_padding table_borders">{!ag.List__r.Name}</td>
                                    </tr>
                                    <apex:variable var="count" value="{!count + 1}" />
                            </apex:repeat>
                        </tbody>
                    </table>
                </div>
                
                <div>
                    <div class="header_related">
                        <apex:variable var="count" value="{!0}" />
                        <apex:repeat value="{!Contact.Travel_Lists__r}" var="row">
                            <apex:variable var="count" value="{!count+1}" />
                        </apex:repeat>
                        Travel Lists ({!count})
                    </div>
                    <table border="0" cellspacing="0" width="100%" class="related_items" style="{!IF(count==0 ,'display: none;','')}">
                        <thead>
                                <tr>
                                    <th class="box_padding table_borders border_top border_left" width="10%">#</th>
                                    <th class="box_padding table_borders border_top" width="72%">Travel List Name</th>
                                    <th class="box_padding table_borders border_top" width="18%">City</th>
                                </tr>
                        </thead>
                        <tbody>
                            <apex:variable var="count" value="{!1}" />
                            <apex:repeat value="{!Contact.Travel_Lists__r}" var="travel" >                   
                                    <tr>
                                        <td  class="box_padding table_borders border_left" align="right">{!count}</td>
                                        <td  class="box_padding table_borders">{!travel.Travel_List__r.Name}</td>
                                        <td  class="box_padding table_borders">{!travel.City__r.Name}</td>
                                    </tr>
                                    <apex:variable var="count" value="{!count + 1}" />
                            </apex:repeat>   
                        </tbody>
                    </table>
                </div>
                
                <div>
                    <div class="header_related">
                        <apex:variable var="count" value="{!0}" />
                        <apex:repeat value="{!Contact.Deals__r}" var="row">
                            <apex:variable var="count" value="{!count+1}" />
                        </apex:repeat>
                        Deals ({!count})
                    </div>
                    <table border="0" cellspacing="0" width="100%" class="related_items" style="{!IF(count==0 ,'display: none;','')}">
                        <thead>
                                <tr>
                                    <th class="box_padding table_borders border_top border_left" width="10%">#</th>
                                    <th class="box_padding table_borders border_top" width="15%">Deal Name</th>
                                    <th class="box_padding table_borders border_top" width="15%">Type</th>
                                    <th class="box_padding table_borders border_top" width="15%">Date</th>
                                    <th class="box_padding table_borders border_top" width="15%">Sent To</th>
                                    <th class="box_padding table_borders border_top" width="15%">Sent By</th>
                                    <th class="box_padding table_borders border_top" width="15%">Notes</th>
                                </tr>
                        </thead>
                        <tbody>
                            <apex:variable var="count" value="{!1}" />
                            <apex:repeat value="{!Contact.Deals__r}" var="deal" >                   
                                    <tr>
                                        <td  class="box_padding table_borders border_left" align="right">{!count}</td>
                                        <td  class="box_padding table_borders ">{!deal.Name}</td>
                                        <td  class="box_padding table_borders ">{!deal.Type__c}</td>
                                        <td  class="box_padding table_borders "><apex:outputText value="{0, date, MM'-'dd'-'yyyy}"><apex:param value="{!deal.Date__c}" /></apex:outputText></td>
                                        <td  class="box_padding table_borders ">{!deal.Sent_To__r.Name}</td>
                                        <td  class="box_padding table_borders ">{!deal.Sent_By__r.Name}</td>
                                        <td  class="box_padding table_borders ">{!deal.Notes__c}</td>
                                    </tr>
                                    <apex:variable var="count" value="{!count + 1}" />
                            </apex:repeat>    
                        </tbody>
                    </table>
                </div>
                
                <div>
                    <div class="header_related">
                        <apex:variable var="count" value="{!0}" />
                        <apex:repeat value="{!Contact.Opportunities}" var="row">
                            <apex:variable var="count" value="{!count+1}" />
                        </apex:repeat>
                        Opportunities ({!count})
                    </div>
                    <table border="0" cellspacing="0" width="100%" class="related_items" style="{!IF(count==0 ,'display: none;','')}">
                        <thead>
                                <tr>
                                    <th class="box_padding table_borders border_top border_left" width="10%">#</th>
                                    <th class="box_padding table_borders border_top" width="18%">Record Type</th>
                                    <th class="box_padding table_borders border_top" width="18%">Opportunity Name</th>
                                    <th class="box_padding table_borders border_top" width="15%">Facilitator</th>
                                    <th class="box_padding table_borders border_top" width="12%">Stage</th>
                                    <th class="box_padding table_borders border_top" width="12%">Amount</th>
                                    <th class="box_padding table_borders border_top" width="15%">Created Date</th>
                                </tr>
                        </thead>
                        <tbody>
                            <apex:variable var="count" value="{!1}" />
                            <apex:repeat value="{!Contact.Opportunities}" var="opp" >                   
                                    <tr>
                                        <td  class="box_padding table_borders border_left" align="right">{!count}</td>
                                        <td  class="box_padding table_borders">{!opp.RecordType.Name}</td>
                                        <td  class="box_padding table_borders">{!opp.Name}</td>
                                        <td  class="box_padding table_borders">{!opp.Facilitator__c}</td>
                                        <td  class="box_padding table_borders">{!opp.StageName}</td>
                                        <td  class="box_padding table_borders">{!opp.Amount}</td>
                                        <td  class="box_padding table_borders">
                                            <apex:outputText value="{0, date, MM'-'dd'-'yyyy}">
                                                <apex:param value="{!opp.CreatedDate}" />
                                            </apex:outputText>
                                        </td>
                                    </tr>
                                    <apex:variable var="count" value="{!count + 1}" />
                            </apex:repeat>   
                        </tbody>
                    </table>
                </div>
                
                <div>
                    <div class="header_related">
                        Scheduling ({!schedulings.size})
                    </div>
                    <table border="0" cellspacing="0" width="100%" class="related_items" style="{!IF(schedulings.size==0 ,'display: none;','')}">
                        <thead>
                                <tr>
                                    <th class="box_padding table_borders border_top border_left" width="10%">#</th>
                                    <th class="box_padding table_borders border_top" width="17%">Call/Metting Name</th>
                                    <th class="box_padding table_borders border_top" width="13%">Appoinment Type</th>
                                    <th class="box_padding table_borders border_top" width="13%">Status</th>
                                    <th class="box_padding table_borders border_top" width="15%">Lead</th>
                                    <th class="box_padding table_borders border_top" width="14%">Confirmed For</th>
                                    <th class="box_padding table_borders border_top" width="18%">Notes</th> 
                                </tr>
                        </thead>
                        <tbody>
                            <apex:variable var="count" value="{!1}" />
                            <apex:repeat value="{!schedulings}" var="scheduling" >                   
                                    <tr>
                                        <td  class="box_padding table_borders border_left" align="right">{!count}</td>
                                        <td  class="box_padding table_borders">{!scheduling.Name}</td>
                                        <td  class="box_padding table_borders">{!scheduling.Type__c}</td>
                                        <td  class="box_padding table_borders">{!scheduling.Status__c}</td>
                                        <td  class="box_padding table_borders">{!scheduling.Lead__r.Name}</td>
                                        <td  class="box_padding table_borders">
                                            <apex:outputText value="{0, date, MM'-'dd'-'yyyy}">
                                                <apex:param value="{! scheduling.Confirmed_Date__c }"/>
                                            </apex:outputText>
                                        </td>
                                        <td  class="box_padding table_borders">{!scheduling.Notes__c}</td>
                                    </tr>
                                    <apex:variable var="count" value="{!count + 1}" />
                            </apex:repeat> 
                        </tbody>
                    </table>
                </div>
                
            </div>
        </div>
        
        <div style="page-break-after:always;">
            <div class="section">
                <span class="section_header">{!Contact.Name} Lists</span>
                <hr/>
                
                <div>
                    <div class="header_related">
                        <apex:variable var="count" value="{!0}" />
                        <apex:repeat value="{!Contact.Folder_List__r}" var="row">
                            <apex:variable var="count" value="{!count+1}" />
                        </apex:repeat>
                        Folder List ({!count})
                    </div>
                    <table border="0" cellspacing="0" width="100%" class="related_items" style="{!IF(count==0 ,'display: none;','')}">
                        <thead>
                                <tr>
                                    <th class="box_padding table_borders border_top border_left" width="10%">#</th>
                                    <th class="box_padding table_borders border_top" width="45%">Folder Name</th>
                                    <th class="box_padding table_borders border_top" width="45%">Folder Color</th>
                                </tr>
                        </thead>
                        <tbody>
                            <apex:variable var="count" value="{!1}" />
                            <apex:repeat value="{!Contact.Folder_List__r}" var="folder" >                   
                                    <tr>
                                        <td  class="box_padding table_borders border_left" align="right">{!count}</td>
                                        <td  class="box_padding table_borders">{!folder.Folder_Name__r.Name}</td>
                                        <td  class="box_padding table_borders">{!folder.Folder_Color__c}</td>
                                    </tr>
                                    <apex:variable var="count" value="{!count + 1}" />
                            </apex:repeat>   
                        </tbody>
                    </table>
                </div>
                
                <div>
                    <div class="header_related">
                        <apex:variable var="count" value="{!0}" />
                        <apex:repeat value="{!Contact.Agreement_List__r}" var="row">
                            <apex:variable var="count" value="{!count+1}" />
                        </apex:repeat>
                        Agreement List ({!count})
                    </div>
                    <table border="0" cellspacing="0" width="100%" class="related_items" style="{!IF(count==0 ,'display: none;','')}">
                        <thead>
                                <tr>
                                    <th class="box_padding table_borders border_top border_left" width="10%">#</th>
                                    <th class="box_padding table_borders border_top" width="30%">Client</th>
                                    <th class="box_padding table_borders border_top" width="25%">Entity</th>
                                    <th class="box_padding table_borders border_top" width="15%">Audit Status</th>
                                    <th class="box_padding table_borders border_top" width="20%">Vertical</th>
                                </tr>
                        </thead>
                        <tbody>
                            <apex:variable var="count" value="{!1}" />
                            <apex:repeat value="{!Contact.Agreement_List__r}" var="aggreement" >                   
                                    <tr>
                                        <td  class="box_padding table_borders border_left" align="right">{!count}</td>
                                        <td  class="box_padding table_borders">{!aggreement.Name}</td>
                                        <td  class="box_padding table_borders">{!aggreement.Entity__c}</td>
                                        <td  class="box_padding table_borders">{!aggreement.Audit_Status__c}</td>
                                        <td  class="box_padding table_borders">{!aggreement.Vertical__c}</td>
                                    </tr>
                                    <apex:variable var="count" value="{!count + 1}" />
                            </apex:repeat>    
                        </tbody>
                    </table>
                </div>
                
                <div>
                    <div class="header_related">
                        <apex:variable var="count" value="{!0}" />
                        <apex:repeat value="{!Contact.Follow_Ups__r}" var="row">
                            <apex:variable var="count" value="{!count+1}" />
                        </apex:repeat>
                        Follow Ups ({!count})
                    </div>
                    <table border="0" cellspacing="0" width="100%" class="related_items" style="{!IF(count==0 ,'display: none;','')}">
                        <thead>
                                <tr>
                                    <th class="box_padding table_borders border_top border_left" width="10%">#</th>
                                    <th class="box_padding table_borders border_top" width="25%">Name</th>
                                    <th class="box_padding table_borders border_top" width="25%">Event</th>
                                    <th class="box_padding table_borders border_top" width="40%">Vertical</th>
                                </tr>
                        </thead>
                        <tbody>
                            <apex:variable var="count" value="{!1}" />
                            <apex:repeat value="{!Contact.Follow_Ups__r}" var="follow" >                   
                                    <tr>
                                        <td  class="box_padding table_borders border_left" align="right">{!count}</td>
                                        <td  class="box_padding table_borders">{!follow.Name}</td>
                                        <td  class="box_padding table_borders">{!follow.Event__c}</td>
                                        <td  class="box_padding table_borders">{!follow.Personal_Message__c}</td>
                                    </tr>
                                    <apex:variable var="count" value="{!count + 1}" />
                            </apex:repeat>
                        </tbody>
                    </table>
                </div>
                
            </div>
        </div>
        
        <div>
            <br/>
            <span class="section_header">Bio</span>
            <hr/>
            <table cellspacing="0" border="0" width="100%">
                <tr>
                    <td width="25%" valign="top" align="left">
                    	<apex:image value="{!URLFOR($Resource.PictureUploader, '/default-avatar.png')}" rendered="{!NOT( hasPicture )}" styleClass="contact-img" />
                        <apex:outputpanel rendered="{!hasPicture}">
                        	<img width="100%" src="/servlet/servlet.FileDownload?file={!file.Id}" />
                        </apex:outputpanel>
                    </td>
                    <td width="57.5%" valign="center" style="padding-left: 10px;">&nbsp;</td>
                    <td width="17.5%" valign="top" align="left">&nbsp;</td>
                </tr>
                <tr>
                	<td colspan="3">
                        <h3>{!Contact.Name}</h3>
                       	<h3>{!Contact.Company__c}, {!Contact.Job_Title__c}</h3>
                        <div class="p_min">                           
                           <apex:outputText value="{!Contact.Biography__c}" escape="false" />
                        </div>
                    </td>
                </tr>
            </table>
        </div>
    </body>
    
</apex:page>